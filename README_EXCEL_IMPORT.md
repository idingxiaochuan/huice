# 网格策略 Excel 导入/导出功能使用说明

## 功能介绍

本功能允许您通过 Excel 文件快速导入和导出网格交易策略，大大提高了策略配置的效率。

## 使用方法

### 创建 Excel 模板

1. 在波段策略编辑器中点击"创建 Excel 模板"按钮
2. 选择保存位置和文件名
3. 系统将生成一个包含示例数据的 Excel 文件

### 编辑 Excel 文件

您可以使用任何电子表格软件（如 Microsoft Excel、WPS 表格、LibreOffice Calc 等）编辑模板文件。文件中包含以下列：

- **级别**：网格的级别编号（从1开始的整数）
- **类型**：网格类型，通常为"NORMAL"
- **买入价**：买入触发价格
- **买入金额**：买入总金额（仅供参考，导入时不使用）
- **买入股数**：买入的股票数量
- **卖出价**：卖出触发价格
- **卖出股数**：卖出的股票数量
- **卖出金额**：卖出总金额（仅供参考，导入时不使用）

### 导入 Excel 数据

1. 在波段策略编辑器中点击"从 Excel 导入"按钮
2. 选择您编辑好的 Excel 文件
3. 系统将自动导入文件中的网格数据
4. 导入成功后会显示导入的网格级别数量

### 导出网格数据到 Excel

1. 在波段策略编辑器中点击"导出到 Excel"按钮
2. 选择保存位置和文件名
3. 系统将把当前的网格策略数据导出到 Excel 文件中

## 注意事项

1. Excel 文件中至少需要包含以下列：买入价、卖出价、买入股数、卖出股数
2. 系统支持多种常见的列名格式，例如"买入价格"和"买价"都会被识别为"买入价"
3. 如果文件中没有"级别"列，系统会自动按行号分配级别
4. 导入时会根据买入价格从高到低对网格级别重新排序
5. 所有价格和数量必须为正数

## 支持的列名

导入功能支持多种常见的列名格式：

- **级别**：级别、level、等级、网格级别、网格等级、序号
- **买入价**：买入价、buy_price、买入价格、买价、买入、买入点
- **卖出价**：卖出价、sell_price、卖出价格、卖价、卖出、卖出点
- **买入股数**：买入股数、buy_shares、买入数量、买入份额、买入份数、买入股票数
- **卖出股数**：卖出股数、sell_shares、卖出数量、卖出份额、卖出份数、卖出股票数
- **类型**：类型、grid_type、网格类型、类别、type

## 要求

此功能需要安装以下Python库：
- pandas
- openpyxl

可以通过以下命令安装：
```
pip install pandas openpyxl
``` 